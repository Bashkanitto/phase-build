import{r as l,p as we,j as e,q as V,t as Ne,v as Me,x as Ce,y as Pe,z as De,A as Ve,F as Le,G as Ae,H as Re,J as Te,K as Ee,L as Ie,M as ee,a as te,O as se,B as z,N as $,h as re,Q as Ge,b as Fe,R as ze}from"./index-BwQ9_pH1.js";import{a as $e,u as Be}from"./procentService-u-au2y4b.js";import{i as ne}from"./productService-Bt3BsnKr.js";import{c as R}from"./clamp-DTmYCdls.js";function Oe(t,s,a="ltr"){const o=l.useRef(null),u=l.useRef(!1),m=l.useRef(!1),x=l.useRef(0),[n,c]=l.useState(!1);return l.useEffect(()=>{u.current=!0},[]),l.useEffect(()=>{var f,b;const r=({x:d,y:g})=>{cancelAnimationFrame(x.current),x.current=requestAnimationFrame(()=>{if(u.current&&o.current){o.current.style.userSelect="none";const v=o.current.getBoundingClientRect();if(v.width&&v.height){const T=R((d-v.left)/v.width,0,1);t({x:a==="ltr"?T:1-T,y:R((g-v.top)/v.height,0,1)})}}})},i=()=>{document.addEventListener("mousemove",y),document.addEventListener("mouseup",j),document.addEventListener("touchmove",w),document.addEventListener("touchend",j)},p=()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",j),document.removeEventListener("touchmove",w),document.removeEventListener("touchend",j)},k=()=>{!m.current&&u.current&&(m.current=!0,typeof(s==null?void 0:s.onScrubStart)=="function"&&s.onScrubStart(),c(!0),i())},j=()=>{m.current&&u.current&&(m.current=!1,c(!1),p(),setTimeout(()=>{typeof(s==null?void 0:s.onScrubEnd)=="function"&&s.onScrubEnd()},0))},M=d=>{k(),d.preventDefault(),y(d)},y=d=>r({x:d.clientX,y:d.clientY}),h=d=>{d.cancelable&&d.preventDefault(),k(),w(d)},w=d=>{d.cancelable&&d.preventDefault(),r({x:d.changedTouches[0].clientX,y:d.changedTouches[0].clientY})};return(f=o.current)==null||f.addEventListener("mousedown",M),(b=o.current)==null||b.addEventListener("touchstart",h,{passive:!1}),()=>{o.current&&(o.current.removeEventListener("mousedown",M),o.current.removeEventListener("touchstart",h))}},[a,t]),{ref:o,active:n}}const[He,B]=we("SliderProvider was not found in tree"),oe=l.forwardRef(({size:t,disabled:s,variant:a,color:o,thumbSize:u,radius:m,...x},n)=>{const{getStyles:c}=B();return e.jsx(V,{tabIndex:-1,variant:a,size:t,ref:n,...c("root"),...x})});oe.displayName="@mantine/core/SliderRoot";const ae=l.forwardRef(({max:t,min:s,value:a,position:o,label:u,dragging:m,onMouseDown:x,onKeyDownCapture:n,labelTransitionProps:c,labelAlwaysOn:r,thumbLabel:i,onFocus:p,onBlur:k,showLabelOnHover:j,isHovered:M,children:y=null,disabled:h},w)=>{const{getStyles:f}=B(),[b,d]=l.useState(!1),g=r||m||b||j&&M;return e.jsxs(V,{tabIndex:0,role:"slider","aria-label":i,"aria-valuemax":t,"aria-valuemin":s,"aria-valuenow":a,ref:w,__vars:{"--slider-thumb-offset":`${o}%`},...f("thumb",{focusable:!0}),mod:{dragging:m,disabled:h},onFocus:()=>{d(!0),typeof p=="function"&&p()},onBlur:()=>{d(!1),typeof k=="function"&&k()},onTouchStart:x,onMouseDown:x,onKeyDownCapture:n,onClick:v=>v.stopPropagation(),children:[y,e.jsx(Ne,{mounted:u!=null&&!!g,transition:"fade",duration:0,...c,children:v=>e.jsx("div",{...f("label",{style:v}),children:u})})]})});ae.displayName="@mantine/core/SliderThumb";function ce({value:t,min:s,max:a}){const o=(t-s)/(a-s)*100;return Math.min(Math.max(o,0),100)}function Ue({mark:t,offset:s,value:a,inverted:o=!1}){return o?typeof s=="number"&&t.value<=s||t.value>=a:typeof s=="number"?t.value>=s&&t.value<=a:t.value<=a}function ie({marks:t,min:s,max:a,disabled:o,value:u,offset:m,inverted:x}){const{getStyles:n}=B();if(!t)return null;const c=t.map((r,i)=>l.createElement(V,{...n("markWrapper"),__vars:{"--mark-offset":`${ce({value:r.value,min:s,max:a})}%`},key:i},e.jsx(V,{...n("mark"),mod:{filled:Ue({mark:r,value:u,offset:m,inverted:x}),disabled:o}}),r.label&&e.jsx("div",{...n("markLabel"),children:r.label})));return e.jsx("div",{children:c})}ie.displayName="@mantine/core/SliderMarks";function le({filled:t,children:s,offset:a,disabled:o,marksOffset:u,inverted:m,containerProps:x,...n}){const{getStyles:c}=B();return e.jsx(e.Fragment,{children:e.jsx(V,{...c("trackContainer"),mod:{disabled:o},...x,children:e.jsxs(V,{...c("track"),mod:{inverted:m,disabled:o},children:[e.jsx(V,{mod:{inverted:m,disabled:o},__vars:{"--slider-bar-width":`calc(${t}% + var(--slider-size))`,"--slider-bar-offset":`calc(${a}% - var(--slider-size))`},...c("bar")}),s,e.jsx(ie,{...n,offset:u,disabled:o,inverted:m})]})})})}le.displayName="@mantine/core/SliderTrack";function We({value:t,containerWidth:s,min:a,max:o,step:u,precision:m}){const n=(s?Math.min(Math.max(t,0),s)/s:t)*(o-a),c=(n!==0?Math.round(n/u)*u:0)+a,r=Math.max(c,a);return m!==void 0?Number(r.toFixed(m)):r}function I(t,s){return parseFloat(t.toFixed(s))}function qe(t){if(!t)return 0;const s=t.toString().split(".");return s.length>1?s[1].length:0}var ue={root:"m_dd36362e",label:"m_c9357328",thumb:"m_c9a9a60a",trackContainer:"m_a8645c2",track:"m_c9ade57f",bar:"m_38aeed47",markWrapper:"m_b7b0423a",mark:"m_dd33bc19",markLabel:"m_68c77a5b"};const Ke={radius:"xl",min:0,max:100,step:1,marks:[],label:t=>t,labelTransitionProps:{transition:"fade",duration:0},labelAlwaysOn:!1,thumbLabel:"",showLabelOnHover:!0,disabled:!1,scale:t=>t},Xe=Ae((t,{size:s,color:a,thumbSize:o,radius:u})=>({root:{"--slider-size":Re(s,"slider-size"),"--slider-color":a?Te(a,t):void 0,"--slider-radius":u===void 0?void 0:Ee(u),"--slider-thumb-size":o!==void 0?Ie(o):"calc(var(--slider-size) * 2)"}})),O=Me((t,s)=>{const a=Ce("Slider",Ke,t),{classNames:o,styles:u,value:m,onChange:x,onChangeEnd:n,size:c,min:r,max:i,step:p,precision:k,defaultValue:j,name:M,marks:y,label:h,labelTransitionProps:w,labelAlwaysOn:f,thumbLabel:b,showLabelOnHover:d,thumbChildren:g,disabled:v,unstyled:T,scale:de,inverted:me,className:pe,style:he,vars:fe,hiddenInputProps:xe,...ve}=a,be=Pe({name:"Slider",props:a,classes:ue,classNames:o,className:pe,styles:u,style:he,vars:fe,varsResolver:Xe,unstyled:T}),{dir:H}=De(),[je,U]=l.useState(!1),[C,P]=Ve({value:typeof m=="number"?R(m,r,i):m,defaultValue:typeof j=="number"?R(j,r,i):j,finalValue:R(0,r,i),onChange:x}),W=l.useRef(C),q=l.useRef(),D=l.useRef(),K=ce({value:C,min:r,max:i}),E=de(C),_e=typeof h=="function"?h(E):h,L=k??qe(p),ge=l.useCallback(({x:S})=>{if(!v){const A=We({value:S,min:r,max:i,step:p,precision:L});P(A),W.current=A}},[v,r,i,p,L,P]),{ref:Se,active:ke}=Oe(ge,{onScrubEnd:()=>n==null?void 0:n(W.current)},H),ye=S=>{var A,X,Y,Z,J,Q;if(!v)switch(S.key){case"ArrowUp":{S.preventDefault(),(A=D.current)==null||A.focus();const N=I(Math.min(Math.max(C+p,r),i),L);P(N),n==null||n(N);break}case"ArrowRight":{S.preventDefault(),(X=D.current)==null||X.focus();const N=I(Math.min(Math.max(H==="rtl"?C-p:C+p,r),i),L);P(N),n==null||n(N);break}case"ArrowDown":{S.preventDefault(),(Y=D.current)==null||Y.focus();const N=I(Math.min(Math.max(C-p,r),i),L);P(N),n==null||n(N);break}case"ArrowLeft":{S.preventDefault(),(Z=D.current)==null||Z.focus();const N=I(Math.min(Math.max(H==="rtl"?C+p:C-p,r),i),L);P(N),n==null||n(N);break}case"Home":{S.preventDefault(),(J=D.current)==null||J.focus(),P(r),n==null||n(r);break}case"End":{S.preventDefault(),(Q=D.current)==null||Q.focus(),P(i),n==null||n(i);break}}};return e.jsx(He,{value:{getStyles:be},children:e.jsxs(oe,{...ve,ref:Le(s,q),onKeyDownCapture:ye,onMouseDownCapture:()=>{var S;return(S=q.current)==null?void 0:S.focus()},size:c,disabled:v,children:[e.jsx(le,{inverted:me,offset:0,filled:K,marks:y,min:r,max:i,value:E,disabled:v,containerProps:{ref:Se,onMouseEnter:d?()=>U(!0):void 0,onMouseLeave:d?()=>U(!1):void 0},children:e.jsx(ae,{max:i,min:r,value:E,position:K,dragging:ke,label:_e,ref:D,labelTransitionProps:w,labelAlwaysOn:f,thumbLabel:b,showLabelOnHover:d,isHovered:je,disabled:v,children:g})}),e.jsx("input",{type:"hidden",name:M,value:E,...xe})]})})});O.classes=ue;O.displayName="@mantine/core/Slider";const Ye=t=>e.jsxs("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:[e.jsx("path",{d:"M1 9L9 1",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M1 1H9V9",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"})]}),Ze=t=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t,children:[e.jsx("path",{d:"M15.8332 4.16663L4.1665 15.8333",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M5.41683 7.50004C6.56742 7.50004 7.50016 6.5673 7.50016 5.41671C7.50016 4.26611 6.56742 3.33337 5.41683 3.33337C4.26624 3.33337 3.3335 4.26611 3.3335 5.41671C3.3335 6.5673 4.26624 7.50004 5.41683 7.50004Z",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e.jsx("path",{d:"M14.5833 16.6667C15.7339 16.6667 16.6667 15.7339 16.6667 14.5833C16.6667 13.4327 15.7339 12.5 14.5833 12.5C13.4327 12.5 12.5 13.4327 12.5 14.5833C12.5 15.7339 13.4327 16.6667 14.5833 16.6667Z",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})]}),Je="_checkbox_jgd0g_11",G={"Discount-modal":"_Discount-modal_jgd0g_5",checkbox:Je,"DiscountModal-button":"_DiscountModal-button_jgd0g_18"},Qe=({isOpen:t,onClose:s,user:a})=>{const[o,u]=l.useState(0),[m,x]=l.useState(0),[n,c]=l.useState(0),[r,i]=l.useState(""),[p,k]=l.useState(null),[j,M]=l.useState(!1),y=async()=>{if(p!==null)try{await $e(p,o),s(),$.addNotification("Изменение скидки",`Скидка для продукта c номером ${p}  успешно изменен`,"success")}catch(f){console.error("Error updating discount:",f),$.addNotification("Изменение скидки","Что то пошло не так","error")}else console.error("No product selected"),i("Выберите продукт")},h=f=>{u(f),c(Number((m*(f/100)).toFixed(2)))},w=async f=>{var d;const b=Number(f);try{const g=await ne(b),v=((d=g.data.vendorGroups[0].features)==null?void 0:d.discount)||0;k(g.data.vendorGroups[0].id),u(v),x(g.data.price),c(g.data.price*(v/100))}catch(g){console.log(g)}};return e.jsxs(ee,{className:G["Discount-modal"],opened:t,onClose:s,children:[e.jsx(te,{placeholder:"Выберите товар",onChange:w,data:a.vendorGroups.map(f=>({value:String(f.product.id),label:f.product.name}))}),r&&e.jsx("p",{className:"danger",children:r}),e.jsxs("div",{className:G.checkbox,children:[e.jsx(se,{size:"xs",checked:j,onChange:f=>M(f.target.checked)}),"Применить ко всем товарам"]}),e.jsx(O,{color:"blue",value:o,onChange:h,min:0,max:100}),e.jsxs("p",{className:G.bonus,children:["Скидка ",n,"₸"]}),e.jsx(z,{onClick:y,className:G["DiscountModal-button"],variantColor:"primary",children:"Сохранить"})]})},et="_checkbox_14mti_11",tt="_bonus_14mti_21",F={"EditProcent-modal":"_EditProcent-modal_14mti_5",checkbox:et,"editProcent-button":"_editProcent-button_14mti_18",bonus:tt},st=({isOpen:t,onClose:s,user:a})=>{const[o,u]=l.useState(0),[m,x]=l.useState(null),[n,c]=l.useState(0),[r,i]=l.useState(null),[p,k]=l.useState(!1),j=async()=>{try{await Be(r,o),$.addNotification("Изменение бонуса",`Бонус для продукта c номером ${r} успешно изменен`,"success"),s()}catch(h){console.error("Error updating bonus:",h),$.addNotification("Изменение бонуса","Что то пошло не так","error")}},M=h=>{u(h),x(Number((n*(h/100)).toFixed(2)))},y=async h=>{var f;const w=Number(h);try{const b=await ne(w),d=((f=b.data.vendorGroups[0].features)==null?void 0:f.bonus)||0;i(b.data.vendorGroups[0].id),u(d),c(b.data.price),x(b.data.price*(d/100))}catch(b){console.log(b)}};return e.jsxs(ee,{className:F["EditProcent-modal"],opened:t,onClose:s,children:[e.jsx(te,{placeholder:"Выберите товар",onChange:y,data:a.vendorGroups.map(h=>({value:String(h.product.id),label:h.product.name}))}),e.jsxs("div",{className:F.checkbox,children:[e.jsx(se,{size:"xs",checked:p,onChange:h=>k(h.target.checked)}),"Применить ко всем товарам"]}),e.jsx(O,{color:"blue",value:o,onChange:M,min:0,max:100}),e.jsxs("p",{className:F.bonus,children:["Бонус: ",m,"₸ "]}),e.jsx(z,{onClick:j,className:F["editProcent-button"],variantColor:"primary",children:"Сохранить"})]})},rt="_tender_1txj4_1",nt="_link_1txj4_49",ot="_brandWrapper_1txj4_98",at="_brand_1txj4_98",_={tender:rt,"tender-user":"_tender-user_1txj4_8","tender-user-info":"_tender-user-info_1txj4_15","tender-user-name":"_tender-user-name_1txj4_28","tender-user-role":"_tender-user-role_1txj4_32","tender-user-statistics":"_tender-user-statistics_1txj4_35","tender-winned":"_tender-winned_1txj4_38",link:nt,"tender-items":"_tender-items_1txj4_60","tender-item":"_tender-item_1txj4_60","tender-image":"_tender-image_1txj4_83",brandWrapper:ot,brand:at},mt=({user:t})=>{const s=re(),[a,o]=l.useState(!1),[u,m]=l.useState(!1),{isAdmin:x}=Fe,n=l.useMemo(()=>Array.from(new Set(t.vendorGroups.map(c=>{var r,i;return(i=(r=c.product)==null?void 0:r.brand)==null?void 0:i.name}).filter(c=>c))),[t.vendorGroups]);return e.jsxs("div",{className:_.tender,children:[e.jsxs("div",{className:_["tender-user"],children:[e.jsxs("div",{className:_["tender-user-info"],children:[e.jsxs("a",{href:`vendor/${t.id}`,children:[e.jsx(Ge,{}),e.jsxs("div",{children:[e.jsx("p",{className:_["tender-user-name"],children:t.firstName}),e.jsx("p",{className:_["tender-user-role"],children:t.role=="admin"?"Админ":"Поставщик"})]})]}),x&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o(!0),className:_.link,children:e.jsx(Ye,{})}),e.jsx("button",{onClick:()=>m(!0),className:_.link,style:{background:"black"},children:e.jsx(Ze,{})})]})]}),e.jsxs("div",{className:_["tender-user-statistics"],children:[e.jsxs("p",{children:["Количество товаров: ",e.jsx("span",{children:t.vendorGroups.length})]}),e.jsx("div",{className:_.brandWrapper,children:n.map((c,r)=>e.jsx("div",{className:_.brand,children:c},r))})]})]}),e.jsx("div",{className:_["tender-items"],children:t.vendorGroups.filter(c=>{var r;return((r=c.product)==null?void 0:r.status)==="active"}).map(c=>{var r,i,p;return e.jsxs("button",{onClick:()=>s(`/product/${c.product.id}`),className:_["tender-item"],children:[e.jsx("img",{src:(i=(r=c.product)==null?void 0:r.images[0])==null?void 0:i.url.replace("http://3.76.32.115:3000","https://api.arbr.kz"),className:_["tender-image"]}),e.jsx("p",{className:_["tender-title"],children:(p=c.product)==null?void 0:p.name})]},c.id)})}),a&&e.jsx(st,{user:t,isOpen:a,onClose:()=>o(!1)}),u&&e.jsx(Qe,{user:t,isOpen:u,onClose:()=>m(!1)})]})},ct={"catalog-switch":"_catalog-switch_3wgxa_1"},pt=()=>{const t=re(),s=ze(),a=s.pathname==="/catalog",o=s.pathname==="/search";return e.jsxs("div",{className:ct["catalog-switch"],children:[e.jsx(z,{onClick:()=>t("/catalog"),variantColor:a?"primary":"secondary",children:"Лучшие"}),e.jsx(z,{onClick:()=>t("/search"),variantColor:o?"primary":"secondary",children:"Поиск"})]})};export{pt as C,mt as T};
